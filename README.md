# muscle-and-blood


🎯 게임 아이디어 로드맵 (v0.1) 💡 개요 장르: 턴제 자동 전투 RPG (영지 경영 + 가챠 기반 용병 수집 + 전략 배치)

핵심 감성: 히어로즈 마이트 앤 매직 + 던전크롤 + 무게와 용맹의 전략성

🧩 1. 핵심 시스템 개요 ⚔️ 12 vs 12 자동 전투 시스템 진형 기반 전투 (15열 x 10열)

용병 클래스별 고유 AI 루틴 + 자동 스킬 발동

전사 - 사거리 1, 이동력3 궁수 - 사거리 4, 이동력3 기병 - 사거리 1, 이동력5 창병 - 사거리 2, 이동력3 마법사 - 사거리3,이동력2 힐러 - 사거리3, 이동력2 소환술사 - 사거리2,이동력2

진형 배치가 승부를 가름

🧿 용병 가챠 시스템 등급, 희귀도, 전용 스킬 보유

무기/방어구 장비 가능

일부 용병은 조합식으로도 획득 가능

🛡 [용맹] 스탯 시스템 전투 시작 시 비례 보호막 생성

보호막 수치에 따라 공격력/마법력 증가

보호막이 깨질수록 딜량 저하

기본 스탯과 용맹 사이의 전략적 투자

⚖️ [무게] 시스템 장비마다 고유 무게 존재

무게 총합이 클수록 행동 순서가 느려짐

반대로 경량 장비 세팅은 빠른 선턴 확보 가능

속도 vs 성능의 딜레마 제공

🗺 던전 크롤 기반 월드맵 플레이어는 '영주' 역할

맵은 타일형 랜덤 생성

각 타일마다 이벤트/전투/자원/용병 모집소 등 존재

적과 조우 시 → 자동 전투 전환

🖌 2. 아트 방향 제안 스타일: 레트로 도트 아트 (이미 완성도 높은 도트 자산 보유!)

캐릭터: 머리 큰 SD 스타일 용병들 + 웅장한 월드맵 타일

몬스터/보스/무기/아이템: 64x64 or 128x128 픽셀 규격(더 커질 수도 있음)

UI: 고전적인 액자형 틀, 질감 있는 패널

⚙️ 3. 기술적 기초 설계 Canvas 기반 전환 필수 (성능 최적화 위해)

구조:

PlayerState: 영주 및 용병 상태 관리

WorldMapManager: 던전 타일 관리

CombatEngine: 자동 전투 로직 담당

StatSystem: 스탯별 효과 계산기 (용맹, 무게 포함)

DecorationManager: 유닛 장식 관리 (팀 깃발은 기본 비활성화, 필요시 setFlagsEnabled(true) 호출)

📆 4. 개발 일정 예시 (가볍게) 단계 목표 예상 기간 v0.1 프로토타입 7vs7 전투 구현 + 스탯 영향 테스트 1~2주 v0.2 맵 연동 타일 이동 + 전투 진입 연계 1주 v0.3 용병 시스템 가챠 + 육성 + 장비 구현 2주 v0.4 UI 정리 본 UI 스케치 → 구현 1주 v0.5 플레이 테스트 밸런싱 및 튜토리얼 작성 2주

🧨 5. 예상 리스크 & 대응 리스크 대응책 성능 병목 (특히 전투 시) 캔버스 + 배치 계산 최소화 자동 전투 밸런스 문제 로그 분석 + 시뮬레이션 자동화 중복된 용병 패턴 AI 루틴 분화, 특수 패시브 설정 무게/용맹 시스템 과도한 복잡성 시각화 + 툴팁 설명 철저히

게임의 빌드 예상도

용병마다 총 3개의 스킬이 달린다. 고용화면에서는 첫 번째 스킬만 확인가능하다. 2,3번째 스킬은 고용 후에 확인 가능(가챠 요소)

용병이 스킬을 쓸 확률은 1,2,3순으로 낮아진다. 즉, 좋은 스킬이 첫번째, 두번째에 달리고, 패시브 스킬이 3번째에 달린 용병이 좋다. (예 : 첫번째 스킬 40% 두번째 스킬 30% 세번째 스킬 20%, 스킬을 안 쓸땐 평타) 용병에게 달리는 스킬은 용병의 클래스에 맞는 스킬들이 주로 붙는편(예외도 있음)

스킬의 종류는 두 가지, 액티브와 패시브. 액티브 - 스킬 순서에 따라 확률적을 사용. 패시브 - 상시 적용. 액티브가 앞에 올수록 좋음

좋은 용병 예 1번째 스킬 - 파이어 스트라이크 (개별) 2번째 스킬 - 파이어 월 (전체) 3번째 스킬 - 마인드 윌 (패시브, 지력 15%증가)

나쁜 용병 예 1번째 스킬 - 스톤 스킨(패시브, 방어력 15%증가) 2번째 스킬 - 파워 스트라이크 (개별) 3번째 스킬 - 퓨리 (액티브, 자기 공격력 버프)

번외

스킬이 나쁘게 달려도 용병의 기본 스탯이 좋으면 쓸수 있는 유형 1번째 스킬 - 버서커 모드(패시브, 공격력 15%증가) 2번째 스킬 - 퓨리(액티브, 자기 공격력 버프) 3번째 스킬 - 리프 어택(개별)

= 패시브가 첫번째에 달렸음에도 퓨리와 중복이 되고, 낮은 확률로 후열의 적을 한명 순삭시킬 수 있기에 메리트가 있음.

[용맹함]

전투 시작시 용병에게 주어지는 방어막 수치를 결정함. 또한, 방어막이 높을 수록 적에게 주는 피해 증가 - 방어막 깎일 수록 낮아짐.
왜? 용병육성의 다양한 빌드를 적용하기 위해서

용맹기사 - 배리어로 방어하면서 첫 턴 강한 공격을 하는 빌드, 몬스터보다 선턴을 잡지 못하면 의미 없음 <- 무게가중치를 낮추는 게 중요함 <- 아이템의 빌드화

용맹탱기사 - 배리어 + 체력 스탯

순수탱기사 - 용맹 하나도 안 찍고 순수 체력, 방어력, 턴 순서 신경 안쓰고 무거운 갑옷 ALL

순수법사 - 지력만 찍음. 유리대포

용맹법사 - 순수법사보다 안정적, 그러나 후반으로 갈수록 낮은 화력, 몬스터보다 선턴을 잡지 못하면(무게가중치가 낮지 않으면) 의미가 없음.

용맹딜법사 - 용맹과 지력을 골고루 찍은 밸런스 형, 탱킹력을 높이기 위해서 선턴을 포기하고 무거운 갑옷입힘. 4.메즈법사 - 지력을 포기하고 용맹 ALL + 무거운 갑옷으로 서브탱킹을 하면서 적에게 상태이상만 거는 용도.(이 경우 세번째 패시브로 스톤스킨이 붙으면 대박)

예상되는 그림

"용맹법사 좋다는 사람 누구임? 후반가면 종이짝에 딜도 안나오는데? 지력만 찍는 게 최고임." VS "난이도 높은 곳으로 갈수록 법사가 딜 한 두방 버티는 게 중요함, 용맹만 찍는 게 짱임 ㅇㅇ"

아이템 시스템

아이템에 달린 스탯이 무거울수록 무게도 올라간다. - 무조건 스탯이 높은 템이 좋은 게 아님, 즉 초중반 아이템이 후반까지도 가는 특이성.(빌드 다양화)
힘, 용맹이 달린 아이템은 무조건 좋다. - 법사의 지팡이조차 힘이 달리면 무게가 0인 수준이라서 가치가 높음. 힘 + 용맹이 둘다 붙으면 최상위템(잘 안나옴)
공격력이 올라가는 헤비 아머도 가치가 있음 - 용맹 시스템에 의해서 방어템 = 탱킹력, 의 공식이 깨짐. 헤비 아머를 차고도 선턴을 잡을 수 있는 건 힘이 높은 기사가 유일하기 때문에 '딜이 올라가는 헤비아머 = 딜러용'의 공식도 깨짐. 법사가 입을 경우 딜은 상승하지만 선턴이 밀리므로 자연스러운 밸런스 조절.
조합시스템 -굳이 게임에 [조합에 따라 어떤 효과 발동], 이런 게 없어도 자연스레 각각의 목적에 맞는 조합이 완성됨

뺑뺑이덱 - 12인 용맹 경&중갑 빠르게 선턴을 잡은 후 용맹 데미지로 초반에 죽이는 덱. 사냥이 빠르기 때문에 뺑뺑이로 적당. 초반에 끝나기 때문에 힐러도 필요없음. 단 후반 사냥터에 가면 무쓸모

레이드덱 - 12인 중&경갑, 용맹 안 찍음. 보스의 체력이 높아서 용맹 데미지가 의미가 없음. 순수 힘기사, 지력법사, 지력힐러의 정통 조합. 선턴도 의미가 없어서 다들 무거운 갑옷 착용

맵뚫기덱 - 12인 전략 파티 더 높은 던전을 뚫기 위한 덱. 탱킹메즈법사, 용맹힐러 같은 전략적인 조합을 요구함. 선턴도 잡으면서 장기전도 필요하기 때문에 최정예 부대.

우리가 고용하는 [용병]은 병종을 리드하는 [지휘관]인 거지. -전투시 [병종]이 대신 나와서 싸움. 용병의 능력치, 기술등은 그대로 적용. -hp는 '병종 수'로 나타냄. 병종 하나마다 기본 체력이 있고, 그것의 합한 값이 전체 체력, 데미지만큼 병종이 죽어나감.(뭔말인지 알지?)

왜?

-출력해야하는 이미지를 획기적으로 줄이기 위해. 만일 용병이 직접 나와서 싸운다고 가정하면 '용병 개개인마다 도트 애니메이션 스프라이트가 있어야함.(물론 그냥 '기본 전사 도트'를 세워놓고 이름만 다 다르게 해도 되긴 함. 하지만 맛이 안 삼) -용병이 지휘관이라고 가정하면, 배틀 필드에 세우는 병종은 7개 혹은 50개(전직시스템)으로 줄어들고 그 갯수의 애니메이션 스프라이트만 있으면 됨.(몬스터도 비슷한 원리) -용병 개개인마다 출력해야하는 이미지는 얼굴이 나오는 간단한 일러스트 한장이면 충분. 이러면 용병 개개인마다의 스프라이트를 설정할 필요도 없으며 개개인의 개성도 표출

정리: 용병 스탯 화면, 장비 화면, 전투화면 옆에 출력되는 이미지는 - 지휘관의 일러스트 배틀 필드에 나오는 도트 애니메이션은 [전사 병종, 궁수 병종, 마법사 병종 등]이면 충분.

시뮬레이션 6vs6 샘플(assets/images/png 파일을 적극이용)

이름	클래스	설명	체력	공격	마법	방어	속도	용맹	무게
1. 라일라	궁수	민첩한 숲의 정찰병, 회피와 선제공격 특화	75	30	0	10	85	20	18
2. 가론	전사	무거운 판금과 방패, 용맹의 상징	120	25	0	45	40	70	42
3. 밀렌	사제	힐러 + 해제 능력, 전투 후반에서 빛남	80	10	40	20	60	35	25
4. 제로드	마법사	고위 마도사, 전체 마법 공격 가능	70	5	65	15	50	30	20
5. 브론	창술사	체력과 공격력 높지만 무방비	150	40	0	5	45	60	35
6. 칼리아	기병	속도 최상, 상태이상 공격 보유	60	28	0	10	95	25	15
이름	종류	설명	체력	공격	마법	방어	속도	용맹	무게
1. 해골 병사	언데드	다수로 몰려오는 기본형 적	50	18	0	8	35	10	10
2. 마도 해골	언데드	저체력, 고출력 범위 마법	40	5	45	5	60	20	12
3. 슬라임 덩어리	변이체	데미지 반사 특성, 끈적한 방어	90	15	0	40	25	15	28
4. 코볼트	야수	빠르고 치명타 위주 공격	70	35	0	10	90	20	14
5. 저주받은 기사	악령	강한 전사형, 용맹이 높음	110	30	0	30	50	60	40
6. 망령 주술사	악령	적 보호막을 깎는 마법 사용	65	10	50	15	55	35	18
시스템 아키텍처: 5+1 계층형 매니저 시스템
covenant의 전투 시스템은 명확한 역할 분담을 기반으로 하는 5개의 핵심 매니저와 1개의 최상위 매니저로 구성됩니다. 각 매니저는 자신의 책임에만 집중하여, 시스템의 확장성과 유지보수성을 극대화합니다.

전투 시스템 흐름도 [ 게임 월드 (영지, 날씨 등) ] │ └─> ① BattleMaster (전투 준비) │ ▼ [ 전투 루프 시작 ] ├── ② EventManager (실시간 사건 처리) ──────> [ 스킬 발동, 유닛 행동 ] ├── ③ StatusEffectManager (턴 종료 시 상태 처리) │ ├── ④ VisualEffectManager (모든 시각 효과) ├── ⑤ BattleLogManager (모든 텍스트 기록) ├── ⑥ DelayManager (애니메이션 진행 대기) └── ⑦ AnimationManager (이동 등 애니메이션) 전투 시스템을 구성하는 7대 매니저

BattleMaster (총괄 매니저) 역할: 전투 시작 직전, 전장 외부의 환경 요소를 전투에 반영하는 최고 지휘관입니다. 주요 기능: 전투 시작 전, 날씨 및 지형 효과를 모든 유닛에게 적용합니다. 영지에서 연구된 기술(전쟁법)이나 음식 효과 등 일시적/영구적 버프를 적용합니다. 작동 시점: 전투 준비 단계(init 함수)에서 단 한 번 호출됩니다.
EventManager (이벤트/트리거 매니저) 역할: 게임 내에서 발생하는 모든 '사건'을 접수하고 구독자에게 전파하는 방송국입니다. 주요 기능: unitDeath, unitAttack 등 특정 이벤트가 발생했음을 알립니다. '죽음의 메아리', '공격 시 흡혈' 등 특정 조건에서 발동하는 스킬(트리거 스킬)을 실행시킵니다. 작동 시점: 특정 사건(유닛 사망, 공격 등)이 발생하는 즉시 실시간으로 작동합니다.
StatusEffectManager (상태이상 매니저) 역할: '독', '마비', '버프' 등 지속시간이 있는 모든 효과를 관리하는 시간 기록원입니다. 주요 기능: 모든 활성 상태이상의 목록과 남은 지속 시간을 관리합니다. 턴 종료 시, 모든 상태이상의 지속시간을 일괄적으로 감소시키고 만료된 효과를 제거합니다. '독 데미지'와 같은 턴 기반 데미지(DoT)를 처리합니다. 작동 시점: 모든 유닛의 행동이 끝난 후, 매 턴의 마지막에 단 한 번 호출됩니다.
VisualEffectManager (시각 효과 매니저) 역할: 전투 중에 발생하는 모든 시각적 연출을 전담하는 감독입니다. 주요 기능: 데미지 및 치유량을 나타내는 숫자 팝업을 화면에 표시합니다. 유닛 머리 위에 현재 걸려있는 상태이상 아이콘을 그립니다. (향후 확장) 스킬 사용 시 발생하는 애니메이션이나 이펙트를 재생합니다. 작동 시점: 매 프레임(requestAnimationFrame)마다 호출되어 모든 시각 효과를 화면에 그려줍니다.
BattleLogManager (전투 로그 매니저) 역할: 전투의 모든 기록을 체계적으로 수집하고 출력하는 서기입니다. 주요 기능: 전투 중 발생하는 모든 사건을 텍스트로 기록합니다. 필요에 따라 반복되는 메시지를 요약하거나, 중요도에 따라 다른 스타일로 표시합니다. 전투 리플레이 기능을 위한 데이터 기반을 제공할 수 있습니다. 작동 시점: logManager.add()가 호출될 때마다 로그를 버퍼에 저장하고, flush()가 호출될 때 화면에 출력합니다.
DelayManager (딜레이 매니저) 역할: 애니메이션이 재생되는 동안 턴 진행을 잠시 멈추는 시간 관리자입니다. 주요 기능: 애니메이션 재생 시간만큼 대기하도록 프로미스를 순차적으로 연결합니다. 다른 매니저에서 요청한 대기 작업이 끝날 때까지 다음 행동을 지연합니다. 작동 시점: AnimationManager 등에서 waitFor()를 호출할 때마다 실행됩니다.
AnimationManager (애니메이션 매니저) 역할: 유닛 이동 등 도트 이미지의 애니메이션을 담당하는 연출가입니다. 주요 기능: 유닛 이동 경로를 큐에 저장하고 requestAnimationFrame으로 부드럽게 재생합니다. 애니메이션이 끝날 때까지 DelayManager와 협력하여 턴을 일시 정지합니다. 작동 시점: 유닛 이동 등의 행동 후 playQueuedMovements()가 호출될 때 실행됩니다. 향후 추가될 최상위 매니저 EnvironmentManager (환경/영지 매니저) 역할: 전투와는 독립적으로, 게임의 전체 월드 상태를 관리하는 서버 컴퓨터입니다. 주요 기능: 영지 내 건물의 건설 진행도를 카운트합니다. 시간의 흐름에 따른 자원(골드, 식량 등)의 축적을 계산합니다. 위치: 전투 시스템의 '외부', 즉 게임의 최상위 레벨에서 항상 동작합니다. 전투 시작 시 BattleMaster가 이 매니저의 정보를 참조하여 전투에 반영하게 됩니다.

## 개발 환경

이 저장소는 Node.js 20 이상의 ES 모듈 환경을 사용합니다.
package.json에 정의된 스크립트를 통해 간단한 테스트를 실행할 수 있습니다.

```bash
npm test
```


